{"ast":null,"code":"/* Copyright (c) 2012-2016 LevelUP contributors\n * See list at <https://github.com/level/levelup#contributing>\n * MIT License\n * <https://github.com/level/levelup/blob/master/LICENSE.md>\n */\nvar EventEmitter = require('events').EventEmitter;\n\nvar inherits = require('util').inherits;\n\nvar deprecate = require('util').deprecate;\n\nvar extend = require('xtend');\n\nvar prr = require('prr');\n\nvar DeferredLevelDOWN = require('deferred-leveldown');\n\nvar IteratorStream = require('level-iterator-stream');\n\nvar Batch = require('./batch');\n\nvar Codec = require('level-codec');\n\nvar getLevelDOWN = require('./leveldown');\n\nvar errors = require('level-errors');\n\nvar util = require('./util');\n\nvar WriteError = errors.WriteError;\nvar ReadError = errors.ReadError;\nvar NotFoundError = errors.NotFoundError;\nvar OpenError = errors.OpenError;\nvar EncodingError = errors.EncodingError;\nvar InitializationError = errors.InitializationError;\nvar LevelUPError = errors.LevelUPError;\nvar getOptions = util.getOptions;\nvar defaultOptions = util.defaultOptions;\nvar dispatchError = util.dispatchError;\n\nfunction getCallback(options, callback) {\n  return typeof options === 'function' ? options : callback;\n} // Possible LevelUP#_status values:\n//  - 'new'     - newly created, not opened or closed\n//  - 'opening' - waiting for the database to be opened, post open()\n//  - 'open'    - successfully opened the database, available for use\n//  - 'closing' - waiting for the database to be closed, post close()\n//  - 'closed'  - database has been successfully closed, should not be\n//                 used except for another open() operation\n\n\nfunction LevelUP(location, options, callback) {\n  if (!(this instanceof LevelUP)) {\n    return new LevelUP(location, options, callback);\n  }\n\n  var error;\n  EventEmitter.call(this);\n  this.setMaxListeners(Infinity);\n\n  if (typeof location === 'function') {\n    options = typeof options === 'object' ? options : {};\n    options.db = location;\n    location = null;\n  } else if (typeof location === 'object' && typeof location.db === 'function') {\n    options = location;\n    location = null;\n  }\n\n  if (typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n\n  if ((!options || typeof options.db !== 'function') && typeof location !== 'string') {\n    error = new InitializationError('Must provide a location for the database');\n\n    if (callback) {\n      return process.nextTick(function () {\n        callback(error);\n      });\n    }\n\n    throw error;\n  }\n\n  options = getOptions(options);\n  this.options = extend(defaultOptions, options);\n  this._codec = new Codec(this.options);\n  this._status = 'new'; // set this.location as enumerable but not configurable or writable\n\n  prr(this, 'location', location, 'e');\n  this.open(callback);\n}\n\ninherits(LevelUP, EventEmitter);\n\nLevelUP.prototype.open = function (callback) {\n  var self = this;\n  var dbFactory;\n  var db;\n\n  if (this.isOpen()) {\n    if (callback) {\n      process.nextTick(function () {\n        callback(null, self);\n      });\n    }\n\n    return this;\n  }\n\n  if (this._isOpening()) {\n    return callback && this.once('open', function () {\n      callback(null, self);\n    });\n  }\n\n  this.emit('opening');\n  this._status = 'opening';\n  this.db = new DeferredLevelDOWN(this.location);\n\n  if (typeof this.options.db !== 'function' && typeof getLevelDOWN !== 'function') {\n    throw new LevelUPError('missing db factory, you need to set options.db');\n  }\n\n  dbFactory = this.options.db || getLevelDOWN();\n  db = dbFactory(this.location);\n  db.open(this.options, function (err) {\n    if (err) {\n      return dispatchError(self, new OpenError(err), callback);\n    }\n\n    self.db.setDb(db);\n    self.db = db;\n    self._status = 'open';\n\n    if (callback) {\n      callback(null, self);\n    }\n\n    self.emit('open');\n    self.emit('ready');\n  });\n};\n\nLevelUP.prototype.close = function (callback) {\n  var self = this;\n\n  if (this.isOpen()) {\n    this._status = 'closing';\n    this.db.close(function () {\n      self._status = 'closed';\n      self.emit('closed');\n\n      if (callback) {\n        callback.apply(null, arguments);\n      }\n    });\n    this.emit('closing');\n    this.db = new DeferredLevelDOWN(this.location);\n  } else if (this._status === 'closed' && callback) {\n    return process.nextTick(callback);\n  } else if (this._status === 'closing' && callback) {\n    this.once('closed', callback);\n  } else if (this._isOpening()) {\n    this.once('open', function () {\n      self.close(callback);\n    });\n  }\n};\n\nLevelUP.prototype.isOpen = function () {\n  return this._status === 'open';\n};\n\nLevelUP.prototype._isOpening = function () {\n  return this._status === 'opening';\n};\n\nLevelUP.prototype.isClosed = function () {\n  return /^clos/.test(this._status);\n};\n\nfunction maybeError(db, options, callback) {\n  if (!db._isOpening() && !db.isOpen()) {\n    dispatchError(db, new ReadError('Database is not open'), callback);\n    return true;\n  }\n}\n\nfunction writeError(db, message, callback) {\n  dispatchError(db, new WriteError(message), callback);\n}\n\nfunction readError(db, message, callback) {\n  dispatchError(db, new ReadError(message), callback);\n}\n\nLevelUP.prototype.get = function (key_, options, callback) {\n  var self = this;\n  var key;\n  callback = getCallback(options, callback);\n\n  if (maybeError(this, options, callback)) {\n    return;\n  }\n\n  if (key_ === null || key_ === undefined || typeof callback !== 'function') {\n    return readError(this, 'get() requires key and callback arguments', callback);\n  }\n\n  options = util.getOptions(options);\n  key = this._codec.encodeKey(key_, options);\n  options.asBuffer = this._codec.valueAsBuffer(options);\n  this.db.get(key, options, function (err, value) {\n    if (err) {\n      if (/notfound/i.test(err) || err.notFound) {\n        err = new NotFoundError('Key not found in database [' + key_ + ']', err);\n      } else {\n        err = new ReadError(err);\n      }\n\n      return dispatchError(self, err, callback);\n    }\n\n    if (callback) {\n      try {\n        value = self._codec.decodeValue(value, options);\n      } catch (e) {\n        return callback(new EncodingError(e));\n      }\n\n      callback(null, value);\n    }\n  });\n};\n\nLevelUP.prototype.put = function (key_, value_, options, callback) {\n  var self = this;\n  var key;\n  var value;\n  callback = getCallback(options, callback);\n\n  if (key_ === null || key_ === undefined) {\n    return writeError(this, 'put() requires a key argument', callback);\n  }\n\n  if (maybeError(this, options, callback)) {\n    return;\n  }\n\n  options = getOptions(options);\n  key = this._codec.encodeKey(key_, options);\n  value = this._codec.encodeValue(value_, options);\n  this.db.put(key, value, options, function (err) {\n    if (err) {\n      return dispatchError(self, new WriteError(err), callback);\n    }\n\n    self.emit('put', key_, value_);\n\n    if (callback) {\n      callback();\n    }\n  });\n};\n\nLevelUP.prototype.del = function (key_, options, callback) {\n  var self = this;\n  var key;\n  callback = getCallback(options, callback);\n\n  if (key_ === null || key_ === undefined) {\n    return writeError(this, 'del() requires a key argument', callback);\n  }\n\n  if (maybeError(this, options, callback)) {\n    return;\n  }\n\n  options = getOptions(options);\n  key = this._codec.encodeKey(key_, options);\n  this.db.del(key, options, function (err) {\n    if (err) {\n      return dispatchError(self, new WriteError(err), callback);\n    }\n\n    self.emit('del', key_);\n\n    if (callback) {\n      callback();\n    }\n  });\n};\n\nLevelUP.prototype.batch = function (arr_, options, callback) {\n  var self = this;\n  var arr;\n\n  if (!arguments.length) {\n    return new Batch(this, this._codec);\n  }\n\n  callback = getCallback(options, callback);\n\n  if (!Array.isArray(arr_)) {\n    return writeError(this, 'batch() requires an array argument', callback);\n  }\n\n  if (maybeError(this, options, callback)) {\n    return;\n  }\n\n  options = getOptions(options);\n  arr = self._codec.encodeBatch(arr_, options);\n  arr = arr.map(function (op) {\n    if (!op.type && op.key !== undefined && op.value !== undefined) {\n      op.type = 'put';\n    }\n\n    return op;\n  });\n  this.db.batch(arr, options, function (err) {\n    if (err) {\n      return dispatchError(self, new WriteError(err), callback);\n    }\n\n    self.emit('batch', arr_);\n\n    if (callback) {\n      callback();\n    }\n  });\n};\n\nLevelUP.prototype.approximateSize = deprecate(function (start_, end_, options, callback) {\n  var self = this;\n  var start;\n  var end;\n  callback = getCallback(options, callback);\n  options = getOptions(options);\n\n  if (start_ === null || start_ === undefined || end_ === null || end_ === undefined || typeof callback !== 'function') {\n    return readError(this, 'approximateSize() requires start, end and callback arguments', callback);\n  }\n\n  start = this._codec.encodeKey(start_, options);\n  end = this._codec.encodeKey(end_, options);\n  this.db.approximateSize(start, end, function (err, size) {\n    if (err) {\n      return dispatchError(self, new OpenError(err), callback);\n    } else if (callback) {\n      callback(null, size);\n    }\n  });\n}, 'db.approximateSize() is deprecated. Use db.db.approximateSize() instead');\n\nLevelUP.prototype.readStream = LevelUP.prototype.createReadStream = function (options) {\n  options = extend({\n    keys: true,\n    values: true\n  }, this.options, options);\n  options.keyEncoding = options.keyEncoding;\n  options.valueEncoding = options.valueEncoding;\n  options = this._codec.encodeLtgt(options);\n  options.keyAsBuffer = this._codec.keyAsBuffer(options);\n  options.valueAsBuffer = this._codec.valueAsBuffer(options);\n\n  if (typeof options.limit !== 'number') {\n    options.limit = -1;\n  }\n\n  return new IteratorStream(this.db.iterator(options), extend(options, {\n    decoder: this._codec.createStreamDecoder(options)\n  }));\n};\n\nLevelUP.prototype.keyStream = LevelUP.prototype.createKeyStream = function (options) {\n  return this.createReadStream(extend(options, {\n    keys: true,\n    values: false\n  }));\n};\n\nLevelUP.prototype.valueStream = LevelUP.prototype.createValueStream = function (options) {\n  return this.createReadStream(extend(options, {\n    keys: false,\n    values: true\n  }));\n};\n\nLevelUP.prototype.toString = function () {\n  return 'LevelUP';\n};\n\nfunction utilStatic(name) {\n  return function (location, callback) {\n    getLevelDOWN()[name](location, callback || function () {});\n  };\n}\n\nmodule.exports = LevelUP;\nmodule.exports.errors = require('level-errors');\nmodule.exports.destroy = deprecate(utilStatic('destroy'), 'levelup.destroy() is deprecated. Use leveldown.destroy() instead');\nmodule.exports.repair = deprecate(utilStatic('repair'), 'levelup.repair() is deprecated. Use leveldown.repair() instead');","map":{"version":3,"sources":["/home/samkuhlmann/Documents/ody/moloch/moloch-dao-badges/node_modules/levelup/lib/levelup.js"],"names":["EventEmitter","require","inherits","deprecate","extend","prr","DeferredLevelDOWN","IteratorStream","Batch","Codec","getLevelDOWN","errors","util","WriteError","ReadError","NotFoundError","OpenError","EncodingError","InitializationError","LevelUPError","getOptions","defaultOptions","dispatchError","getCallback","options","callback","LevelUP","location","error","call","setMaxListeners","Infinity","db","process","nextTick","_codec","_status","open","prototype","self","dbFactory","isOpen","_isOpening","once","emit","err","setDb","close","apply","arguments","isClosed","test","maybeError","writeError","message","readError","get","key_","key","undefined","encodeKey","asBuffer","valueAsBuffer","value","notFound","decodeValue","e","put","value_","encodeValue","del","batch","arr_","arr","length","Array","isArray","encodeBatch","map","op","type","approximateSize","start_","end_","start","end","size","readStream","createReadStream","keys","values","keyEncoding","valueEncoding","encodeLtgt","keyAsBuffer","limit","iterator","decoder","createStreamDecoder","keyStream","createKeyStream","valueStream","createValueStream","toString","utilStatic","name","module","exports","destroy","repair"],"mappings":"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","sourcesContent":["/* Copyright (c) 2012-2016 LevelUP contributors\n * See list at <https://github.com/level/levelup#contributing>\n * MIT License\n * <https://github.com/level/levelup/blob/master/LICENSE.md>\n */\n\nvar EventEmitter = require('events').EventEmitter\nvar inherits = require('util').inherits\nvar deprecate = require('util').deprecate\nvar extend = require('xtend')\nvar prr = require('prr')\nvar DeferredLevelDOWN = require('deferred-leveldown')\nvar IteratorStream = require('level-iterator-stream')\nvar Batch = require('./batch')\nvar Codec = require('level-codec')\nvar getLevelDOWN = require('./leveldown')\nvar errors = require('level-errors')\nvar util = require('./util')\n\nvar WriteError = errors.WriteError\nvar ReadError = errors.ReadError\nvar NotFoundError = errors.NotFoundError\nvar OpenError = errors.OpenError\nvar EncodingError = errors.EncodingError\nvar InitializationError = errors.InitializationError\nvar LevelUPError = errors.LevelUPError\n\nvar getOptions = util.getOptions\nvar defaultOptions = util.defaultOptions\nvar dispatchError = util.dispatchError\n\nfunction getCallback (options, callback) {\n  return typeof options === 'function' ? options : callback\n}\n\n// Possible LevelUP#_status values:\n//  - 'new'     - newly created, not opened or closed\n//  - 'opening' - waiting for the database to be opened, post open()\n//  - 'open'    - successfully opened the database, available for use\n//  - 'closing' - waiting for the database to be closed, post close()\n//  - 'closed'  - database has been successfully closed, should not be\n//                 used except for another open() operation\n\nfunction LevelUP (location, options, callback) {\n  if (!(this instanceof LevelUP)) { return new LevelUP(location, options, callback) }\n\n  var error\n\n  EventEmitter.call(this)\n  this.setMaxListeners(Infinity)\n\n  if (typeof location === 'function') {\n    options = typeof options === 'object' ? options : {}\n    options.db = location\n    location = null\n  } else if (typeof location === 'object' && typeof location.db === 'function') {\n    options = location\n    location = null\n  }\n\n  if (typeof options === 'function') {\n    callback = options\n    options = {}\n  }\n\n  if ((!options || typeof options.db !== 'function') && typeof location !== 'string') {\n    error = new InitializationError(\n        'Must provide a location for the database')\n    if (callback) {\n      return process.nextTick(function () {\n        callback(error)\n      })\n    }\n    throw error\n  }\n\n  options = getOptions(options)\n  this.options = extend(defaultOptions, options)\n  this._codec = new Codec(this.options)\n  this._status = 'new'\n  // set this.location as enumerable but not configurable or writable\n  prr(this, 'location', location, 'e')\n\n  this.open(callback)\n}\n\ninherits(LevelUP, EventEmitter)\n\nLevelUP.prototype.open = function (callback) {\n  var self = this\n  var dbFactory\n  var db\n\n  if (this.isOpen()) {\n    if (callback) { process.nextTick(function () { callback(null, self) }) }\n    return this\n  }\n\n  if (this._isOpening()) {\n    return callback && this.once('open', function () { callback(null, self) })\n  }\n\n  this.emit('opening')\n  this._status = 'opening'\n  this.db = new DeferredLevelDOWN(this.location)\n\n  if (typeof this.options.db !== 'function' &&\n      typeof getLevelDOWN !== 'function') {\n    throw new LevelUPError('missing db factory, you need to set options.db')\n  }\n\n  dbFactory = this.options.db || getLevelDOWN()\n  db = dbFactory(this.location)\n\n  db.open(this.options, function (err) {\n    if (err) {\n      return dispatchError(self, new OpenError(err), callback)\n    }\n    self.db.setDb(db)\n    self.db = db\n    self._status = 'open'\n    if (callback) { callback(null, self) }\n    self.emit('open')\n    self.emit('ready')\n  })\n}\n\nLevelUP.prototype.close = function (callback) {\n  var self = this\n\n  if (this.isOpen()) {\n    this._status = 'closing'\n    this.db.close(function () {\n      self._status = 'closed'\n      self.emit('closed')\n      if (callback) { callback.apply(null, arguments) }\n    })\n    this.emit('closing')\n    this.db = new DeferredLevelDOWN(this.location)\n  } else if (this._status === 'closed' && callback) {\n    return process.nextTick(callback)\n  } else if (this._status === 'closing' && callback) {\n    this.once('closed', callback)\n  } else if (this._isOpening()) {\n    this.once('open', function () {\n      self.close(callback)\n    })\n  }\n}\n\nLevelUP.prototype.isOpen = function () {\n  return this._status === 'open'\n}\n\nLevelUP.prototype._isOpening = function () {\n  return this._status === 'opening'\n}\n\nLevelUP.prototype.isClosed = function () {\n  return (/^clos/).test(this._status)\n}\n\nfunction maybeError (db, options, callback) {\n  if (!db._isOpening() && !db.isOpen()) {\n    dispatchError(db, new ReadError('Database is not open'), callback)\n    return true\n  }\n}\n\nfunction writeError (db, message, callback) {\n  dispatchError(db, new WriteError(message), callback)\n}\n\nfunction readError (db, message, callback) {\n  dispatchError(db, new ReadError(message), callback)\n}\n\nLevelUP.prototype.get = function (key_, options, callback) {\n  var self = this\n  var key\n\n  callback = getCallback(options, callback)\n\n  if (maybeError(this, options, callback)) { return }\n\n  if (key_ === null || key_ === undefined || typeof callback !== 'function') {\n    return readError(this, 'get() requires key and callback arguments', callback)\n  }\n\n  options = util.getOptions(options)\n  key = this._codec.encodeKey(key_, options)\n\n  options.asBuffer = this._codec.valueAsBuffer(options)\n\n  this.db.get(key, options, function (err, value) {\n    if (err) {\n      if ((/notfound/i).test(err) || err.notFound) {\n        err = new NotFoundError(\n            'Key not found in database [' + key_ + ']', err)\n      } else {\n        err = new ReadError(err)\n      }\n      return dispatchError(self, err, callback)\n    }\n    if (callback) {\n      try {\n        value = self._codec.decodeValue(value, options)\n      } catch (e) {\n        return callback(new EncodingError(e))\n      }\n      callback(null, value)\n    }\n  })\n}\n\nLevelUP.prototype.put = function (key_, value_, options, callback) {\n  var self = this\n  var key\n  var value\n\n  callback = getCallback(options, callback)\n\n  if (key_ === null || key_ === undefined) { return writeError(this, 'put() requires a key argument', callback) }\n\n  if (maybeError(this, options, callback)) { return }\n\n  options = getOptions(options)\n  key = this._codec.encodeKey(key_, options)\n  value = this._codec.encodeValue(value_, options)\n\n  this.db.put(key, value, options, function (err) {\n    if (err) {\n      return dispatchError(self, new WriteError(err), callback)\n    }\n    self.emit('put', key_, value_)\n    if (callback) { callback() }\n  })\n}\n\nLevelUP.prototype.del = function (key_, options, callback) {\n  var self = this\n  var key\n\n  callback = getCallback(options, callback)\n\n  if (key_ === null || key_ === undefined) { return writeError(this, 'del() requires a key argument', callback) }\n\n  if (maybeError(this, options, callback)) { return }\n\n  options = getOptions(options)\n  key = this._codec.encodeKey(key_, options)\n\n  this.db.del(key, options, function (err) {\n    if (err) {\n      return dispatchError(self, new WriteError(err), callback)\n    }\n    self.emit('del', key_)\n    if (callback) { callback() }\n  })\n}\n\nLevelUP.prototype.batch = function (arr_, options, callback) {\n  var self = this\n  var arr\n\n  if (!arguments.length) { return new Batch(this, this._codec) }\n\n  callback = getCallback(options, callback)\n\n  if (!Array.isArray(arr_)) { return writeError(this, 'batch() requires an array argument', callback) }\n\n  if (maybeError(this, options, callback)) { return }\n\n  options = getOptions(options)\n  arr = self._codec.encodeBatch(arr_, options)\n  arr = arr.map(function (op) {\n    if (!op.type && op.key !== undefined && op.value !== undefined) { op.type = 'put' }\n    return op\n  })\n\n  this.db.batch(arr, options, function (err) {\n    if (err) {\n      return dispatchError(self, new WriteError(err), callback)\n    }\n    self.emit('batch', arr_)\n    if (callback) { callback() }\n  })\n}\n\nLevelUP.prototype.approximateSize = deprecate(function (start_, end_, options, callback) {\n  var self = this\n  var start\n  var end\n\n  callback = getCallback(options, callback)\n\n  options = getOptions(options)\n\n  if (start_ === null || start_ === undefined || end_ === null ||\n      end_ === undefined || typeof callback !== 'function') {\n    return readError(this, 'approximateSize() requires start, end and callback arguments', callback)\n  }\n\n  start = this._codec.encodeKey(start_, options)\n  end = this._codec.encodeKey(end_, options)\n\n  this.db.approximateSize(start, end, function (err, size) {\n    if (err) {\n      return dispatchError(self, new OpenError(err), callback)\n    } else if (callback) {\n      callback(null, size)\n    }\n  })\n}, 'db.approximateSize() is deprecated. Use db.db.approximateSize() instead')\n\nLevelUP.prototype.readStream =\nLevelUP.prototype.createReadStream = function (options) {\n  options = extend({keys: true, values: true}, this.options, options)\n\n  options.keyEncoding = options.keyEncoding\n  options.valueEncoding = options.valueEncoding\n\n  options = this._codec.encodeLtgt(options)\n  options.keyAsBuffer = this._codec.keyAsBuffer(options)\n  options.valueAsBuffer = this._codec.valueAsBuffer(options)\n\n  if (typeof options.limit !== 'number') { options.limit = -1 }\n\n  return new IteratorStream(this.db.iterator(options), extend(options, {\n    decoder: this._codec.createStreamDecoder(options)\n  }))\n}\n\nLevelUP.prototype.keyStream =\nLevelUP.prototype.createKeyStream = function (options) {\n  return this.createReadStream(extend(options, { keys: true, values: false }))\n}\n\nLevelUP.prototype.valueStream =\nLevelUP.prototype.createValueStream = function (options) {\n  return this.createReadStream(extend(options, { keys: false, values: true }))\n}\n\nLevelUP.prototype.toString = function () {\n  return 'LevelUP'\n}\n\nfunction utilStatic (name) {\n  return function (location, callback) {\n    getLevelDOWN()[name](location, callback || function () {})\n  }\n}\n\nmodule.exports = LevelUP\nmodule.exports.errors = require('level-errors')\nmodule.exports.destroy = deprecate(\n  utilStatic('destroy'),\n  'levelup.destroy() is deprecated. Use leveldown.destroy() instead'\n)\nmodule.exports.repair = deprecate(\n  utilStatic('repair'),\n  'levelup.repair() is deprecated. Use leveldown.repair() instead'\n)\n"]},"metadata":{},"sourceType":"script"}