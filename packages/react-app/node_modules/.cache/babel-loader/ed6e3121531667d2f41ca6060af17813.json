{"ast":null,"code":"/* Copyright (c) 2017 Rod Vagg, MIT License */\nfunction AbstractChainedBatch(db) {\n  this._db = db;\n  this._operations = [];\n  this._written = false;\n}\n\nAbstractChainedBatch.prototype._serializeKey = function (key) {\n  return this._db._serializeKey(key);\n};\n\nAbstractChainedBatch.prototype._serializeValue = function (value) {\n  return this._db._serializeValue(value);\n};\n\nAbstractChainedBatch.prototype._checkWritten = function () {\n  if (this._written) throw new Error('write() already called on this batch');\n};\n\nAbstractChainedBatch.prototype.put = function (key, value) {\n  this._checkWritten();\n\n  var err = this._db._checkKey(key, 'key', this._db._isBuffer);\n\n  if (err) throw err;\n  key = this._serializeKey(key);\n  value = this._serializeValue(value);\n  if (typeof this._put == 'function') this._put(key, value);else this._operations.push({\n    type: 'put',\n    key: key,\n    value: value\n  });\n  return this;\n};\n\nAbstractChainedBatch.prototype.del = function (key) {\n  this._checkWritten();\n\n  var err = this._db._checkKey(key, 'key', this._db._isBuffer);\n\n  if (err) throw err;\n  key = this._serializeKey(key);\n  if (typeof this._del == 'function') this._del(key);else this._operations.push({\n    type: 'del',\n    key: key\n  });\n  return this;\n};\n\nAbstractChainedBatch.prototype.clear = function () {\n  this._checkWritten();\n\n  this._operations = [];\n  if (typeof this._clear == 'function') this._clear();\n  return this;\n};\n\nAbstractChainedBatch.prototype.write = function (options, callback) {\n  this._checkWritten();\n\n  if (typeof options == 'function') callback = options;\n  if (typeof callback != 'function') throw new Error('write() requires a callback argument');\n  if (typeof options != 'object') options = {};\n  this._written = true;\n  if (typeof this._write == 'function') return this._write(callback);\n  if (typeof this._db._batch == 'function') return this._db._batch(this._operations, options, callback);\n  process.nextTick(callback);\n};\n\nmodule.exports = AbstractChainedBatch;","map":{"version":3,"sources":["/home/samkuhlmann/Documents/ody/moloch/moloch-dao-badges/node_modules/deferred-leveldown/node_modules/abstract-leveldown/abstract-chained-batch.js"],"names":["AbstractChainedBatch","db","_db","_operations","_written","prototype","_serializeKey","key","_serializeValue","value","_checkWritten","Error","put","err","_checkKey","_isBuffer","_put","push","type","del","_del","clear","_clear","write","options","callback","_write","_batch","process","nextTick","module","exports"],"mappings":"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","sourcesContent":["/* Copyright (c) 2017 Rod Vagg, MIT License */\n\nfunction AbstractChainedBatch (db) {\n  this._db         = db\n  this._operations = []\n  this._written    = false\n}\n\nAbstractChainedBatch.prototype._serializeKey = function (key) {\n  return this._db._serializeKey(key)\n}\n\nAbstractChainedBatch.prototype._serializeValue = function (value) {\n  return this._db._serializeValue(value)\n}\n\nAbstractChainedBatch.prototype._checkWritten = function () {\n  if (this._written)\n    throw new Error('write() already called on this batch')\n}\n\nAbstractChainedBatch.prototype.put = function (key, value) {\n  this._checkWritten()\n\n  var err = this._db._checkKey(key, 'key', this._db._isBuffer)\n  if (err)\n    throw err\n\n  key = this._serializeKey(key)\n  value = this._serializeValue(value)\n\n  if (typeof this._put == 'function' )\n    this._put(key, value)\n  else\n    this._operations.push({ type: 'put', key: key, value: value })\n\n  return this\n}\n\nAbstractChainedBatch.prototype.del = function (key) {\n  this._checkWritten()\n\n  var err = this._db._checkKey(key, 'key', this._db._isBuffer)\n  if (err) throw err\n\n  key = this._serializeKey(key)\n\n  if (typeof this._del == 'function' )\n    this._del(key)\n  else\n    this._operations.push({ type: 'del', key: key })\n\n  return this\n}\n\nAbstractChainedBatch.prototype.clear = function () {\n  this._checkWritten()\n\n  this._operations = []\n\n  if (typeof this._clear == 'function' )\n    this._clear()\n\n  return this\n}\n\nAbstractChainedBatch.prototype.write = function (options, callback) {\n  this._checkWritten()\n\n  if (typeof options == 'function')\n    callback = options\n  if (typeof callback != 'function')\n    throw new Error('write() requires a callback argument')\n  if (typeof options != 'object')\n    options = {}\n\n  this._written = true\n\n  if (typeof this._write == 'function' )\n    return this._write(callback)\n\n  if (typeof this._db._batch == 'function')\n    return this._db._batch(this._operations, options, callback)\n\n  process.nextTick(callback)\n}\n\nmodule.exports = AbstractChainedBatch\n"]},"metadata":{},"sourceType":"script"}