{"ast":null,"code":"'use strict';\n\nconst EC = require('elliptic').ec;\n\nconst ec = new EC('secp256k1');\nmodule.exports = {\n  verify: async (signature, publicKey, data) => {\n    if (!signature) {\n      throw new Error('No signature given');\n    }\n\n    if (!publicKey) {\n      throw new Error('Given publicKey was undefined');\n    }\n\n    if (!data) {\n      throw new Error('Given input data was undefined');\n    }\n\n    let res = false;\n    const key = ec.keyPair({\n      pub: publicKey,\n      pubEnc: 'hex'\n    });\n\n    try {\n      res = ec.verify(data, signature, key);\n    } catch (e) {// Catches 'Error: Signature without r or s'\n    }\n\n    return Promise.resolve(res);\n  }\n};","map":{"version":3,"sources":["/home/samkuhlmann/Documents/ody/moloch/moloch-dao-badges/node_modules/orbit-db-keystore/src/verifiers/verifierv0.js"],"names":["EC","require","ec","module","exports","verify","signature","publicKey","data","Error","res","key","keyPair","pub","pubEnc","e","Promise","resolve"],"mappings":"AAAA;;AAEA,MAAMA,EAAE,GAAGC,OAAO,CAAC,UAAD,CAAP,CAAoBC,EAA/B;;AACA,MAAMA,EAAE,GAAG,IAAIF,EAAJ,CAAO,WAAP,CAAX;AAEAG,MAAM,CAACC,OAAP,GAAiB;AACfC,EAAAA,MAAM,EAAE,OAAOC,SAAP,EAAkBC,SAAlB,EAA6BC,IAA7B,KAAsC;AAC5C,QAAI,CAACF,SAAL,EAAgB;AACd,YAAM,IAAIG,KAAJ,CAAU,oBAAV,CAAN;AACD;;AACD,QAAI,CAACF,SAAL,EAAgB;AACd,YAAM,IAAIE,KAAJ,CAAU,+BAAV,CAAN;AACD;;AACD,QAAI,CAACD,IAAL,EAAW;AACT,YAAM,IAAIC,KAAJ,CAAU,gCAAV,CAAN;AACD;;AACD,QAAIC,GAAG,GAAG,KAAV;AACA,UAAMC,GAAG,GAAGT,EAAE,CAACU,OAAH,CAAW;AACrBC,MAAAA,GAAG,EAAEN,SADgB;AAErBO,MAAAA,MAAM,EAAE;AAFa,KAAX,CAAZ;;AAIA,QAAI;AACFJ,MAAAA,GAAG,GAAGR,EAAE,CAACG,MAAH,CAAUG,IAAV,EAAgBF,SAAhB,EAA2BK,GAA3B,CAAN;AACD,KAFD,CAEE,OAAOI,CAAP,EAAU,CACV;AACD;;AACD,WAAOC,OAAO,CAACC,OAAR,CAAgBP,GAAhB,CAAP;AACD;AAtBc,CAAjB","sourcesContent":["'use strict'\n\nconst EC = require('elliptic').ec\nconst ec = new EC('secp256k1')\n\nmodule.exports = {\n  verify: async (signature, publicKey, data) => {\n    if (!signature) {\n      throw new Error('No signature given')\n    }\n    if (!publicKey) {\n      throw new Error('Given publicKey was undefined')\n    }\n    if (!data) {\n      throw new Error('Given input data was undefined')\n    }\n    let res = false\n    const key = ec.keyPair({\n      pub: publicKey,\n      pubEnc: 'hex'\n    })\n    try {\n      res = ec.verify(data, signature, key)\n    } catch (e) {\n      // Catches 'Error: Signature without r or s'\n    }\n    return Promise.resolve(res)\n  }\n}\n"]},"metadata":{},"sourceType":"script"}