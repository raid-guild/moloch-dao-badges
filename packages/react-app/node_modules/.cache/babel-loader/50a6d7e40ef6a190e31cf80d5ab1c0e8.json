{"ast":null,"code":"var inherits = require('inherits');\n\nvar Readable = require('readable-stream').Readable;\n\nvar extend = require('xtend');\n\nvar EncodingError = require('level-errors').EncodingError;\n\nmodule.exports = ReadStream;\ninherits(ReadStream, Readable);\n\nfunction ReadStream(iterator, options) {\n  if (!(this instanceof ReadStream)) return new ReadStream(iterator, options);\n  Readable.call(this, extend(options, {\n    objectMode: true\n  }));\n  this._iterator = iterator;\n  this._destroyed = false;\n  this._decoder = null;\n  if (options && options.decoder) this._decoder = options.decoder;\n  this.on('end', this._cleanup.bind(this));\n}\n\nReadStream.prototype._read = function () {\n  var self = this;\n  if (this._destroyed) return;\n\n  this._iterator.next(function (err, key, value) {\n    if (self._destroyed) return;\n    if (err) return self.emit('error', err);\n\n    if (key === undefined && value === undefined) {\n      self.push(null);\n    } else {\n      if (!self._decoder) return self.push({\n        key: key,\n        value: value\n      });\n\n      try {\n        var value = self._decoder(key, value);\n      } catch (err) {\n        self.emit('error', new EncodingError(err));\n        self.push(null);\n        return;\n      }\n\n      self.push(value);\n    }\n  });\n};\n\nReadStream.prototype.destroy = ReadStream.prototype._cleanup = function () {\n  var self = this;\n  if (this._destroyed) return;\n  this._destroyed = true;\n\n  this._iterator.end(function (err) {\n    if (err) return self.emit('error', err);\n    self.emit('close');\n  });\n};","map":{"version":3,"sources":["/home/samkuhlmann/Documents/ody/moloch/moloch-dao-badges/node_modules/levelup/node_modules/level-iterator-stream/index.js"],"names":["inherits","require","Readable","extend","EncodingError","module","exports","ReadStream","iterator","options","call","objectMode","_iterator","_destroyed","_decoder","decoder","on","_cleanup","bind","prototype","_read","self","next","err","key","value","emit","undefined","push","destroy","end"],"mappings":"AAAA,IAAIA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAtB;;AACA,IAAIC,QAAQ,GAAGD,OAAO,CAAC,iBAAD,CAAP,CAA2BC,QAA1C;;AACA,IAAIC,MAAM,GAAGF,OAAO,CAAC,OAAD,CAApB;;AACA,IAAIG,aAAa,GAAGH,OAAO,CAAC,cAAD,CAAP,CAAwBG,aAA5C;;AAEAC,MAAM,CAACC,OAAP,GAAiBC,UAAjB;AACAP,QAAQ,CAACO,UAAD,EAAaL,QAAb,CAAR;;AAEA,SAASK,UAAT,CAAoBC,QAApB,EAA8BC,OAA9B,EAAsC;AACpC,MAAI,EAAE,gBAAgBF,UAAlB,CAAJ,EAAmC,OAAO,IAAIA,UAAJ,CAAeC,QAAf,EAAyBC,OAAzB,CAAP;AACnCP,EAAAA,QAAQ,CAACQ,IAAT,CAAc,IAAd,EAAoBP,MAAM,CAACM,OAAD,EAAU;AAClCE,IAAAA,UAAU,EAAE;AADsB,GAAV,CAA1B;AAGA,OAAKC,SAAL,GAAiBJ,QAAjB;AACA,OAAKK,UAAL,GAAkB,KAAlB;AACA,OAAKC,QAAL,GAAgB,IAAhB;AACA,MAAIL,OAAO,IAAIA,OAAO,CAACM,OAAvB,EAAgC,KAAKD,QAAL,GAAgBL,OAAO,CAACM,OAAxB;AAChC,OAAKC,EAAL,CAAQ,KAAR,EAAe,KAAKC,QAAL,CAAcC,IAAd,CAAmB,IAAnB,CAAf;AACD;;AAEDX,UAAU,CAACY,SAAX,CAAqBC,KAArB,GAA6B,YAAU;AACrC,MAAIC,IAAI,GAAG,IAAX;AACA,MAAI,KAAKR,UAAT,EAAqB;;AAErB,OAAKD,SAAL,CAAeU,IAAf,CAAoB,UAASC,GAAT,EAAcC,GAAd,EAAmBC,KAAnB,EAAyB;AAC3C,QAAIJ,IAAI,CAACR,UAAT,EAAqB;AACrB,QAAIU,GAAJ,EAAS,OAAOF,IAAI,CAACK,IAAL,CAAU,OAAV,EAAmBH,GAAnB,CAAP;;AACT,QAAIC,GAAG,KAAKG,SAAR,IAAqBF,KAAK,KAAKE,SAAnC,EAA8C;AAC5CN,MAAAA,IAAI,CAACO,IAAL,CAAU,IAAV;AACD,KAFD,MAEO;AACL,UAAI,CAACP,IAAI,CAACP,QAAV,EAAoB,OAAOO,IAAI,CAACO,IAAL,CAAU;AAAEJ,QAAAA,GAAG,EAAEA,GAAP;AAAYC,QAAAA,KAAK,EAAEA;AAAnB,OAAV,CAAP;;AAEpB,UAAI;AACF,YAAIA,KAAK,GAAGJ,IAAI,CAACP,QAAL,CAAcU,GAAd,EAAmBC,KAAnB,CAAZ;AACD,OAFD,CAEE,OAAOF,GAAP,EAAY;AACZF,QAAAA,IAAI,CAACK,IAAL,CAAU,OAAV,EAAmB,IAAItB,aAAJ,CAAkBmB,GAAlB,CAAnB;AACAF,QAAAA,IAAI,CAACO,IAAL,CAAU,IAAV;AACA;AACD;;AACDP,MAAAA,IAAI,CAACO,IAAL,CAAUH,KAAV;AACD;AACF,GAjBD;AAkBD,CAtBD;;AAwBAlB,UAAU,CAACY,SAAX,CAAqBU,OAArB,GACAtB,UAAU,CAACY,SAAX,CAAqBF,QAArB,GAAgC,YAAU;AACxC,MAAII,IAAI,GAAG,IAAX;AACA,MAAI,KAAKR,UAAT,EAAqB;AACrB,OAAKA,UAAL,GAAkB,IAAlB;;AAEA,OAAKD,SAAL,CAAekB,GAAf,CAAmB,UAASP,GAAT,EAAa;AAC9B,QAAIA,GAAJ,EAAS,OAAOF,IAAI,CAACK,IAAL,CAAU,OAAV,EAAmBH,GAAnB,CAAP;AACTF,IAAAA,IAAI,CAACK,IAAL,CAAU,OAAV;AACD,GAHD;AAID,CAVD","sourcesContent":["var inherits = require('inherits');\nvar Readable = require('readable-stream').Readable;\nvar extend = require('xtend');\nvar EncodingError = require('level-errors').EncodingError;\n\nmodule.exports = ReadStream;\ninherits(ReadStream, Readable);\n\nfunction ReadStream(iterator, options){\n  if (!(this instanceof ReadStream)) return new ReadStream(iterator, options);\n  Readable.call(this, extend(options, {\n    objectMode: true\n  }));\n  this._iterator = iterator;\n  this._destroyed = false;\n  this._decoder = null;\n  if (options && options.decoder) this._decoder = options.decoder;\n  this.on('end', this._cleanup.bind(this));\n}\n\nReadStream.prototype._read = function(){\n  var self = this;\n  if (this._destroyed) return;\n\n  this._iterator.next(function(err, key, value){\n    if (self._destroyed) return;\n    if (err) return self.emit('error', err);\n    if (key === undefined && value === undefined) {\n      self.push(null);\n    } else {\n      if (!self._decoder) return self.push({ key: key, value: value });\n\n      try {\n        var value = self._decoder(key, value);\n      } catch (err) {\n        self.emit('error', new EncodingError(err));\n        self.push(null);\n        return;\n      }\n      self.push(value);\n    }\n  });\n};\n\nReadStream.prototype.destroy =\nReadStream.prototype._cleanup = function(){\n  var self = this;\n  if (this._destroyed) return;\n  this._destroyed = true;\n\n  this._iterator.end(function(err){\n    if (err) return self.emit('error', err);\n    self.emit('close');\n  });\n};\n\n"]},"metadata":{},"sourceType":"script"}